name: DatasetAnalysis
python_env: env\python_env.yaml

entry_points:
    main:
        parameters:

            annotation_conversion:
                description: If True, annotation conversion will be done with specified options. Else, annotation conversion will not be done
                type: str
                required: True

            class_list:
                description: List of classes to detect. E.g. --class_list Class1,Class2,...,ClassN
                type: str
                required: True

            src_label_format:
                description: Source format of labels
                type: str
                required: True

            dst_label_format:
                description: Destination format of labels
                type: str
                required: True


            input_label_dir:
                description: Source annotation folder
                type: str
                required: True

            annotation_conversor_output_label_dir:
                description: Destination annotation folder
                type: str
                required: True

            annotation_conversor_artifact_name:
                description: Name of the artifact.
                type: str
                required: True

            annotation_conversor_artifact_type:
                description: Type of the artifact.
                type: str
                required: True

            annotation_conversor_artifact_description:
                description: A brief description of this artifact.
                type: str
                required: True



            augmentations:
                description: If True, augmentations will be done with specified options. Else, augmentations will not be done
                type: str
                required: True

            image_directory:
                description: Directory to fetch images.
                type: str
                required: True

            labels_directory:
                description: Directory to fetch labels.
                type: str
                required: True

            augmentation_file:
                description: YAML file with albumentations style
                type: str
                required: True

            merge_augmented_images:
                description: True if want to merge automatically augmented instances with images and labels dir
                type: str
                required: True

            augmentations_artifact_name:
                description: Name of the artifact.
                type: str
                required: True

            augmentations_artifact_type:
                description: Type of the artifact.
                type: str
                required: True

            augmentations_artifact_description:
                description: A brief description of this artifact.
                type: str
                required: True



        command: "python main.py --annotation_conversion {annotation_conversion}
                                --class_list {class_list} --src_label_format {src_label_format}
                                --dst_label_format {dst_label_format} --input_label_dir {input_label_dir}
                                --annotation_conversor_output_label_dir {annotation_conversor_output_label_dir}
                                --annotation_conversor_artifact_name {annotation_conversor_artifact_name}
                                --annotation_conversor_artifact_type {annotation_conversor_artifact_type}
                                --annotation_conversor_artifact_description {annotation_conversor_artifact_description}
                                --augmentations {augmentations}
                                --image_directory {image_directory} --labels_directory {labels_directory}
                                --augmentation_file {augmentation_file} --merge_augmented_images {merge_augmented_images}
                                --augmentations_artifact_name {augmentations_artifact_name}
                                --augmentations_artifact_type {augmentations_artifact_type}
                                --augmentations_artifact_description {augmentations_artifact_description}
                                "

    extra_preprocessing:
        parameters:
            type:
                description: Type of extra preprocessing steps
                type: str
                choices: remove_extra_labels, rename_labels, erase_images_with_empty_labels
                required: True

            image_directory:
                description: Path where images are stored.
                type: str
                required: True

            labels_directory:
                description: Path where labels are stored.
                type: str
                required: True

            labels_to_maintain:
                description: comma separated list of labels to keep. The rest will be removed.
                type: str
                required: True

            current_labels_list:
                description: comma separated list of current labels to be renamed.
                type: str
                required: True

            target_labels_list:
                description: comma separated list of new labels.
                type: str
                required: True

            artifact_name:
                description: Name of the artifact.
                type: str
                required: True

            artifact_type:
                description: Type of the artifact.
                type: str
                required: True

            artifact_description:
                description: A brief description of this artifact.
                type: str
                required: True

        command: "python main_extra_preprocessing.py --type {type}
                  --image_directory {image_directory} --labels_directory {labels_directory}
                  --labels_to_maintain {labels_to_maintain}
                  --current_labels_list {current_labels_list}
                  --target_labels_list {target_labels_list}
                  --artifact_name {artifact_name} --artifact_type {artifact_type}
                  --artifact_description {artifact_description}"

