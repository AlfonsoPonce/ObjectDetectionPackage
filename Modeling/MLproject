name: Modeling

entry_points:
    main:
        parameters:
            dataset_format:
                description: Label format. It can be VOC, COCO or YOLO
                type: str
                required: True

            class_list:
                description: List of classes to detect. E.g. --class_list Class1,Class2,...,ClassN
                type: str
                required: True

            images_dir:
                description: Folder where images are stored
                type: str
                required: True

            labels_dir:
                description: Folder where labels are stored
                type: str
                required: True

            output_dir:
                description: Output directory for results
                type: str
                required: True

            train_split:
                description: Ratio of training instances
                type: str
                required: True

            model:
                description: Name of the model. Must be the name of the file under model_repo (without file extension)
                type: str
                required: True

            train_config:
                description: Training configuration dictionary. Must be given a string formatted with json.
                type: str
                required: True

            artifact_name:
                description: Name of the artifact.
                type: str
                required: True

            artifact_type:
                description: Type of the artifact.
                type: str
                required: True

            artifact_description:
                description: A brief description of this artifact.
                type: str
                required: True



        command: "python main_train.py --dataset_format {dataset_format}
                                --class_list {class_list} --images_dir {images_dir}
                                --labels_dir {labels_dir} --output_dir {output_dir}
                                --train_split {train_split}
                                --model {model} --artifact_name {artifact_name}
                                --artifact_type {artifact_type}
                                --artifact_description {artifact_description}
                                --train_config {train_config}
                                "
    model_selection:
        parameters:

            images_dir:
                description: Folder where images are stored
                type: str
                required: True

            labels_dir:
                description: Folder where labels are stored
                type: str
                required: True

            dataset_format:
                description: Label format. It can be VOC, COCO or YOLO
                type: str
                required: True

            class_list:
                description: List of classes to detect. E.g. --class_list Class1,Class2,...,ClassN
                type: str
                required: True

            train_config:
                description: Training configuration dictionary. Must be given a string formatted with json.
                type: str
                required: True

            output_dir:
                description: Output directory for results
                type: str
                required: True

            model_list:
                description: Comma-separated list (no whitespaces) of models to be compared. Each model name must be the name of the file under model_repo (without file extension)
                type: str
                required: True

            metric_criteria:
                description: Selects which metric will be used to perform comparison
                type: str
                required: True

            K:
                description: Selects K for K_Crossvalidation if applied.
                type: str
                required: True


            selection_method:
                description: Method to perform model comparison and selection. If more than two models are listed, and pairwise comparison method is specified, then it will perform all possible comparisons.
                type: str
                required: True

            hypothesis_test:
                description: Hypothesis test to perform model comparison.
                type: str
                required: True

            significance_level:
                description: Significance level to execute hypothesis testing. Must be between [0-1)
                type: str
                required: True


            artifact_name:
                description: Name of the artifact.
                type: str
                required: True

            artifact_type:
                description: Type of the artifact.
                type: str
                required: True

            artifact_description:
                description: A brief description of this artifact.
                type: str
                required: True
        command: "python main_model_selection.py --dataset_format {dataset_format}
                                --class_list {class_list} --images_dir {images_dir}
                                --labels_dir {labels_dir} --output_dir {output_dir}
                                --metric_criteria {metric_criteria} --K {K}
                                --significance_level {significance_level}
                                --selection_method {selection_method} --hypothesis_test {hypothesis_test}
                                --model_list {model_list} --artifact_name {artifact_name}
                                --artifact_type {artifact_type}
                                --artifact_description {artifact_description}
                                --train_config {train_config}
                                "

    inference:
        parameters:
            inference_type:
                description: Type of data which inference will be done.
                type: str
                choices: video, dataset
                required: True

            input_folder:
                description: Folder where input data is stored.
                type: str
                required: True

            output_folder:
                description: Folder output data will be stored
                type: str
                required: True

            model_name:
                description: Name of the model. Must be the name of the file under model_repo (without file extension)
                type: str
                required: True

            checkpoint:
                description: Name of model checkpoint. If no checkpoint is used, type None.
                type: str
                required: True

            detection_threshold:
                description: threshold that sets minimum confidence to an object to be detected
                type: str
                required: True

            resize:
                description: Comma separated list of 2 dimensions to resize image
                type: str
                required: True

            artifact_name:
                description: Name of the artifact.
                type: str
                required: True

            artifact_type:
                description: Type of the artifact.
                type: str
                required: True

            artifact_description:
                description: A brief description of this artifact.
                type: str
                required: True

        command: "python main_inference.py --inference_type {inference_type} --input_folder {input_folder}
                                 --output_folder {output_folder} --model_name {model_name}
                                 --checkpoint {checkpoint} --detection_threshold {detection_threshold}
                                 --resize {resize} --artifact_name {artifact_name}
                                 --artifact_type {artifact_type} --artifact_description {artifact_description}"